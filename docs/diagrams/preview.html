<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mermaid Diagrams Preview</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .diagram-section {
            margin-bottom: 40px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
        }
        .diagram-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
        }
        .instructions {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 30px;
            border-radius: 4px;
        }
        .instructions h3 {
            margin-top: 0;
            color: #1976d2;
        }
        .instructions ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        .instructions li {
            margin: 5px 0;
        }
        .file-list {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
        }
        .file-list h4 {
            margin-top: 0;
            color: #495057;
        }
        .file-list ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .file-list li {
            margin: 5px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎨 Mermaid Diagrams Preview</h1>
        
        <div class="instructions">
            <h3>📋 How to Use This Preview:</h3>
            <ol>
                <li><strong>Open this file</strong> in your browser</li>
                <li><strong>View all diagrams</strong> rendered with enhanced styling</li>
                <li><strong>Use for presentations</strong> or documentation</li>
                <li><strong>Export images</strong> by right-clicking on diagrams</li>
            </ol>
            <p><strong>💡 Tip:</strong> This preview shows all diagrams with the enhanced styling, emojis, and colors optimized for GitHub preview.</p>
        </div>

        <div class="file-list">
            <h4>📁 Available Diagram Files:</h4>
            <ul>
                <li>database-architecture.mmd - Main system architecture</li>
                <li>multi-country-database.mmd - Global deployment strategy</li>
                <li>entity-relationship.mmd - Database schema relationships</li>
                <li>data-flow.mmd - Order creation process flow</li>
                <li>security-architecture.mmd - Security layers and access control</li>
                <li>monitoring-architecture.mmd - Observability and monitoring stack</li>
                <li>backup-recovery.mmd - Disaster recovery and backup strategy</li>
                <li>scalability-architecture.mmd - Scaling and performance architecture</li>
                <li>table-structure.mmd - Database table organization</li>
                <li>indexing-strategy.mmd - Database indexing and optimization</li>
            </ul>
        </div>

        <div class="diagram-section">
            <div class="diagram-title">
                <span>🏗️ Database Architecture</span>
            </div>
            <div class="mermaid" id="db-arch">
                %%{init: {'theme':'base', 'themeVariables': { 'primaryColor': '#ff0000', 'primaryTextColor': '#fff', 'primaryBorderColor': '#7C0000', 'lineColor': '#F8B229', 'secondaryColor': '#006100', 'tertiaryColor': '#fff'}}}%% 
                graph TB
                    subgraph APP["🖥️ APPLICATION LAYER"]
                        API["🌐 API Gateway<br/>Port: 3001"]
                        AUTH["🔐 Authentication Service<br/>Port: 3002"]
                        ORDER["📦 Order Service<br/>Port: 3003"]
                        PAYMENT["💳 Payment Service<br/>Port: 3004"]
                        DELIVERY["🚚 Delivery Service<br/>Port: 3005"]
                        NOTIFICATION["📱 Notification Service<br/>Port: 3006"]
                    end
                    
                    subgraph DB["🗄️ DATABASE LAYER"]
                        subgraph PRIMARY["📊 PRIMARY DATABASE"]
                            POSTGRES[("🐘 PostgreSQL 15+<br/>with PostGIS<br/>Port: 5432")]
                            USERS["👥 Users & Roles"]
                            ORDERS["📋 Orders & Items"]
                            MERCHANTS["🏪 Merchants & Products"]
                            LOCATIONS["📍 Locations & Zones"]
                            PAYMENTS["💰 Payments"]
                            TRACKING["📍 Delivery Tracking"]
                            REVIEWS["⭐ Reviews & Ratings"]
                            NOTIFICATIONS["🔔 Notifications"]
                            ANALYTICS["📈 Analytics Events"]
                        end
                        
                        subgraph CACHE["⚡ CACHE LAYER"]
                            REDIS[("🔴 Redis 7+<br/>Port: 6379")]
                            SESSIONS["🔑 User Sessions"]
                            CACHE_DATA["💾 API Response Cache"]
                            REALTIME["⚡ Real-time Data"]
                            RATELIMIT["🚦 Rate Limiting"]
                        end
                        
                        subgraph SEARCH["🔍 SEARCH ENGINE"]
                            ELASTIC[("🔎 Elasticsearch 8.8+<br/>Port: 9200")]
                            SEARCH_ORDERS["🔍 Order Search"]
                            SEARCH_PRODUCTS["🔍 Product Search"]
                            SEARCH_MERCHANTS["🔍 Merchant Search"]
                            SEARCH_USERS["🔍 User Search"]
                            SEARCH_ANALYTICS["🔍 Analytics Search"]
                        end
                    end
                    
                    subgraph EXTERNAL["🌐 EXTERNAL SERVICES"]
                        STRIPE["💳 Stripe Payment<br/>API"]
                        MAPS["🗺️ Google Maps API"]
                        SMS["📱 Twilio SMS<br/>API"]
                        EMAIL["📧 SendGrid Email<br/>API"]
                    end
                    
                    %% Connections
                    API -.->|"HTTP/HTTPS"| POSTGRES
                    API -.->|"Redis Protocol"| REDIS
                    API -.->|"HTTP"| ELASTIC
                    
                    AUTH -.->|"SQL"| POSTGRES
                    AUTH -.->|"Redis Protocol"| REDIS
                    
                    ORDER -.->|"SQL"| POSTGRES
                    ORDER -.->|"Redis Protocol"| REDIS
                    ORDER -.->|"HTTP"| ELASTIC
                    
                    PAYMENT -.->|"SQL"| POSTGRES
                    PAYMENT -.->|"HTTPS"| STRIPE
                    
                    DELIVERY -.->|"SQL"| POSTGRES
                    DELIVERY -.->|"HTTPS"| MAPS
                    
                    NOTIFICATION -.->|"SQL"| POSTGRES
                    NOTIFICATION -.->|"HTTPS"| SMS
                    NOTIFICATION -.->|"HTTPS"| EMAIL
                    
                    %% Internal connections
                    POSTGRES --> USERS
                    POSTGRES --> ORDERS
                    POSTGRES --> MERCHANTS
                    POSTGRES --> LOCATIONS
                    POSTGRES --> PAYMENTS
                    POSTGRES --> TRACKING
                    POSTGRES --> REVIEWS
                    POSTGRES --> NOTIFICATIONS
                    POSTGRES --> ANALYTICS
                    
                    REDIS --> SESSIONS
                    REDIS --> CACHE_DATA
                    REDIS --> REALTIME
                    REDIS --> RATELIMIT
                    
                    ELASTIC --> SEARCH_ORDERS
                    ELASTIC --> SEARCH_PRODUCTS
                    ELASTIC --> SEARCH_MERCHANTS
                    ELASTIC --> SEARCH_USERS
                    ELASTIC --> SEARCH_ANALYTICS
            </div>
        </div>

        <div class="diagram-section">
            <div class="diagram-title">
                <span>🌍 Multi-Country Database Architecture</span>
            </div>
            <div class="mermaid" id="multi-country">
                %%{init: {'theme':'base', 'themeVariables': { 'primaryColor': '#1f77b4', 'primaryTextColor': '#fff', 'primaryBorderColor': '#0d47a1', 'lineColor': '#ff7f0e', 'secondaryColor': '#2ca02c', 'tertiaryColor': '#d62728'}}}%%
                graph TB
                    subgraph GLOBAL["🌍 GLOBAL LOAD BALANCER"]
                        GLOBAL_LB["⚖️ Global Load Balancer<br/>AWS CloudFront"]
                        DNS["🌐 DNS with Geo-routing<br/>Route 53"]
                    end
                    
                    subgraph US["🇺🇸 UNITED STATES"]
                        subgraph US_EAST["📍 US-East (Virginia)"]
                            US_API1["🌐 API Gateway US-East<br/>Port: 3001"]
                            US_DB_MASTER[("🐘 PostgreSQL Master<br/>Port: 5432")]
                            US_DB_SLAVE1[("🐘 PostgreSQL Slave 1<br/>Port: 5433")]
                            US_REDIS1[("🔴 Redis Cluster<br/>Port: 6379")]
                            US_ES1[("🔎 Elasticsearch<br/>Port: 9200")]
                        end
                        
                        subgraph US_WEST["📍 US-West (Oregon)"]
                            US_API2["🌐 API Gateway US-West<br/>Port: 3001"]
                            US_DB_SLAVE2[("🐘 PostgreSQL Slave 2<br/>Port: 5433")]
                            US_REDIS2[("🔴 Redis Cluster<br/>Port: 6379")]
                            US_ES2[("🔎 Elasticsearch<br/>Port: 9200")]
                        end
                    end
                    
                    subgraph INDIA["🇮🇳 INDIA"]
                        subgraph IN_MUMBAI["📍 Mumbai (ap-south-1)"]
                            IN_API1["🌐 API Gateway Mumbai<br/>Port: 3001"]
                            IN_DB_MASTER[("🐘 PostgreSQL Master<br/>Port: 5432")]
                            IN_DB_SLAVE1[("🐘 PostgreSQL Slave 1<br/>Port: 5433")]
                            IN_REDIS1[("🔴 Redis Cluster<br/>Port: 6379")]
                            IN_ES1[("🔎 Elasticsearch<br/>Port: 9200")]
                        end
                        
                        subgraph IN_BANGALORE["📍 Bangalore (ap-southeast-1)"]
                            IN_API2["🌐 API Gateway Bangalore<br/>Port: 3001"]
                            IN_DB_SLAVE2[("🐘 PostgreSQL Slave 2<br/>Port: 5433")]
                            IN_REDIS2[("🔴 Redis Cluster<br/>Port: 6379")]
                            IN_ES2[("🔎 Elasticsearch<br/>Port: 9200")]
                        end
                    end
                    
                    subgraph UK["🇬🇧 UNITED KINGDOM"]
                        subgraph UK_LONDON["📍 London (eu-west-2)"]
                            UK_API1["🌐 API Gateway London<br/>Port: 3001"]
                            UK_DB_MASTER[("🐘 PostgreSQL Master<br/>Port: 5432")]
                            UK_DB_SLAVE1[("🐘 PostgreSQL Slave 1<br/>Port: 5433")]
                            UK_REDIS1[("🔴 Redis Cluster<br/>Port: 6379")]
                            UK_ES1[("🔎 Elasticsearch<br/>Port: 9200")]
                        end
                    end
                    
                    DNS -->|"Geo-routing"| GLOBAL_LB
                    GLOBAL_LB -->|"US Traffic"| US_API1
                    GLOBAL_LB -->|"US Traffic"| US_API2
                    GLOBAL_LB -->|"India Traffic"| IN_API1
                    GLOBAL_LB -->|"India Traffic"| IN_API2
                    GLOBAL_LB -->|"UK Traffic"| UK_API1
            </div>
        </div>

        <div class="diagram-section">
            <div class="diagram-title">
                <span>🔒 Security Architecture</span>
            </div>
            <div class="mermaid" id="security">
                %%{init: {'theme':'base', 'themeVariables': { 'primaryColor': '#d32f2f', 'primaryTextColor': '#fff', 'primaryBorderColor': '#b71c1c', 'lineColor': '#ff9800', 'secondaryColor': '#388e3c', 'tertiaryColor': '#1976d2'}}}%%
                graph TB
                    subgraph CLIENT_LAYER["🖥️ CLIENT LAYER"]
                        CLIENT["📱 Client Applications<br/>Mobile & Web"]
                        API_GW["🌐 API Gateway<br/>Rate Limiting & CORS"]
                        AUTH_SVC["🔐 Authentication Service<br/>JWT & OAuth2"]
                    end
                    
                    subgraph SECURITY_LAYER["🔒 SECURITY LAYER"]
                        subgraph ACCESS_CONTROL["🛡️ ACCESS CONTROL"]
                            RBAC["👥 Role-Based Access Control<br/>RBAC Matrix"]
                            RLS["🔐 Row Level Security<br/>Data Isolation"]
                            PERMISSIONS["📋 Permission Matrix<br/>Granular Permissions"]
                        end
                        
                        subgraph DATA_PROTECTION["🔐 DATA PROTECTION"]
                            ENCRYPTION["🔒 Data Encryption<br/>AES-256 at Rest"]
                            HASHING["🔑 Password Hashing<br/>bcrypt + Salt"]
                            AUDIT["📝 Audit Trail<br/>Complete Activity Log"]
                        end
                        
                        subgraph NETWORK_SECURITY["🌐 NETWORK SECURITY"]
                            TLS["🔐 TLS 1.3<br/>End-to-End Encryption"]
                            VPN["🔒 VPN Access<br/>Private Network"]
                            FIREWALL["🔥 Database Firewall<br/>IP Whitelisting"]
                        end
                    end
                    
                    subgraph DATABASE_LAYER["🗄️ DATABASE LAYER"]
                        POSTGRES[("🐘 PostgreSQL<br/>Encrypted Storage")]
                        REDIS[("🔴 Redis<br/>Encrypted Cache")]
                        ELASTIC[("🔎 Elasticsearch<br/>Encrypted Search")]
                    end
                    
                    CLIENT -->|"HTTPS"| API_GW
                    API_GW -->|"JWT Validation"| AUTH_SVC
                    AUTH_SVC -->|"Role Check"| RBAC
                    RBAC -->|"Permission Check"| RLS
                    RLS -->|"Data Access"| PERMISSIONS
                    
                    API_GW -->|"TLS 1.3"| TLS
                    TLS -->|"Encrypted Connection"| FIREWALL
                    FIREWALL -->|"Filtered Access"| POSTGRES
            </div>
        </div>
    </div>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#1f77b4',
                primaryTextColor: '#fff',
                primaryBorderColor: '#0d47a1',
                lineColor: '#ff7f0e',
                secondaryColor: '#2ca02c',
                tertiaryColor: '#d62728'
            }
        });
    </script>
</body>
</html>
