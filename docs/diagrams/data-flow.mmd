%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#1f77b4',
    'primaryTextColor': '#000000',
    'primaryBorderColor': '#0d47a1',
    'lineColor': '#ff7f0e',
    'secondaryColor': '#2ca02c',
    'tertiaryColor': '#d62728',
    'background': '#ffffff',
    'mainBkg': '#f8f9fa',
    'secondBkg': '#e9ecef',
    'tertiaryBkg': '#dee2e6',
    'actorBkg': '#ffffff',
    'actorBorder': '#1f77b4',
    'actorTextColor': '#000000',
    'actorLineColor': '#1f77b4',
    'signalColor': '#ff7f0e',
    'signalTextColor': '#000000',
    'labelBoxBkgColor': '#ffffff',
    'labelBoxBorderColor': '#1f77b4',
    'labelTextColor': '#000000',
    'loopTextColor': '#000000',
    'activationBkgColor': '#2ca02c',
    'activationBorderColor': '#1f77b4',
    'textColor': '#000000',
    'noteBkgColor': '#fff2cc',
    'noteBorderColor': '#F5A623',
    'noteTextColor': '#000000'
  },
  'sequence': {
    'diagramMarginX': 80,
    'diagramMarginY': 30,
    'actorMargin': 80,
    'width': 200,
    'height': 90,
    'boxMargin': 20,
    'boxTextMargin': 12,
    'noteMargin': 20,
    'messageMargin': 50,
    'mirrorActors': true,
    'bottomMarginAdj': 1,
    'useMaxWidth': true,
    'rightAngles': false,
    'showSequenceNumbers': false
  },
  'fontFamily': 'Segoe UI, Arial, sans-serif',
  'fontSize': 18,
  'fontWeight': '600'
}}%%
sequenceDiagram
    participant C as <b>ğŸ‘¤ Customer</b>
    participant API as <b>ğŸŒ API Gateway</b>
    participant AUTH as <b>ğŸ” Auth Service</b>
    participant ORDER as <b>ğŸ“¦ Order Service</b>
    participant PAYMENT as <b>ğŸ’³ Payment Service</b>
    participant DELIVERY as <b>ğŸšš Delivery Service</b>
    participant DB as <b>ğŸ˜ PostgreSQL</b>
    participant CACHE as <b>ğŸ”´ Redis</b>
    participant SEARCH as <b>ğŸ” Elasticsearch</b>
    
    Note over C,SEARCH: <b>ğŸ“‹ ORDER CREATION FLOW</b>
    
    C->>+API: <b>ğŸ“ Create Order Request</b><br/><span style='color:#666;font-size:14px'>POST /api/v4/orders</span>
    API->>+AUTH: <b>ğŸ” Validate JWT Token</b>
    AUTH->>+CACHE: <b>ğŸ”‘ Check User Session</b>
    CACHE-->>-AUTH: <b>âœ… Session Valid</b>
    AUTH-->>-API: <b>âœ… Token Valid</b>
    
    API->>+ORDER: <b>ğŸ“¦ Process Order Request</b>
    ORDER->>+DB: <b>ğŸ’¾ Save Order Data</b>
    DB-->>-ORDER: <b>âœ… Order Saved</b>
    ORDER->>+DB: <b>ğŸ’¾ Save Order Items</b>
    DB-->>-ORDER: <b>âœ… Items Saved</b>
    ORDER->>+CACHE: <b>âš¡ Cache Order Data</b>
    CACHE-->>-ORDER: <b>âœ… Data Cached</b>
    ORDER->>+SEARCH: <b>ğŸ” Index Order for Search</b>
    SEARCH-->>-ORDER: <b>âœ… Order Indexed</b>
    ORDER-->>-API: <b>âœ… Order Created Successfully</b>
    
    API->>+PAYMENT: <b>ğŸ’³ Process Payment</b>
    PAYMENT->>+DB: <b>ğŸ’¾ Save Payment Record</b>
    DB-->>-PAYMENT: <b>âœ… Payment Saved</b>
    PAYMENT->>+CACHE: <b>âš¡ Cache Payment Status</b>
    CACHE-->>-PAYMENT: <b>âœ… Status Cached</b>
    PAYMENT-->>-API: <b>âœ… Payment Processed</b>
    
    API->>+DELIVERY: <b>ğŸšš Assign Delivery Partner</b>
    DELIVERY->>+DB: <b>ğŸ’¾ Update Order Status</b>
    DB-->>-DELIVERY: <b>âœ… Status Updated</b>
    DELIVERY->>+CACHE: <b>âš¡ Update Real-time Status</b>
    CACHE-->>-DELIVERY: <b>âœ… Status Updated</b>
    DELIVERY-->>-API: <b>âœ… Delivery Assigned</b>
    
    API-->>-C: <b>ğŸ‰ Order Confirmation</b><br/><span style='color:#666;font-size:14px'>Order ID: #12345</span>
