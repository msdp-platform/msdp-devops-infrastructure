%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#1f77b4',
    'primaryTextColor': '#000000',
    'primaryBorderColor': '#0d47a1',
    'lineColor': '#ff7f0e',
    'secondaryColor': '#2ca02c',
    'tertiaryColor': '#d62728',
    'background': '#ffffff',
    'mainBkg': '#f8f9fa',
    'secondBkg': '#e9ecef',
    'tertiaryBkg': '#dee2e6',
    'nodeBkg': '#ffffff',
    'nodeBorder': '#1f77b4',
    'clusterBkg': '#f0f8ff',
    'clusterBorder': '#4A90E2',
    'defaultLinkColor': '#ff7f0e',
    'titleColor': '#0d47a1',
    'textColor': '#000000',
    'nodeTextColor': '#000000',
    'clusterTextColor': '#000000'
  },
  'flowchart': {
    'nodeSpacing': 80,
    'rankSpacing': 120,
    'curve': 'basis',
    'padding': 35,
    'useMaxWidth': true,
    'htmlLabels': true,
    'diagramPadding': 30
  },
  'fontFamily': 'Segoe UI, Arial, sans-serif',
  'fontSize': 18,
  'fontWeight': '600'
}}%%
graph TB
    subgraph GIT_REPO["📚 GIT REPOSITORY"]
        INFRA_REPO["<b>🏗️ Infrastructure Repo</b><br/><span style='color:#666;font-size:14px'>Crossplane Compositions</span>"]
        APP_REPO["<b>📦 Application Repo</b><br/><span style='color:#666;font-size:14px'>Helm Charts & Manifests</span>"]
        CONFIG_REPO["<b>⚙️ Configuration Repo</b><br/><span style='color:#666;font-size:14px'>Environment Configs</span>"]
    end
    
    subgraph CONTROL_PLANE["🎛️ CONTROL PLANE CLUSTER"]
        subgraph CROSSPLANE["🔧 CROSSPLANE"]
            CROSSPLANE_CORE["<b>🧠 Crossplane Core</b><br/><span style='color:#666;font-size:14px'>Controller & API</span>"]
            AWS_PROVIDER["<b>☁️ AWS Provider</b><br/><span style='color:#666;font-size:14px'>AWS Resources</span>"]
            GCP_PROVIDER["<b>☁️ GCP Provider</b><br/><span style='color:#666;font-size:14px'>GCP Resources</span>"]
            AZURE_PROVIDER["<b>☁️ Azure Provider</b><br/><span style='color:#666;font-size:14px'>Azure Resources</span>"]
            COMPOSITIONS["<b>📋 Compositions</b><br/><span style='color:#666;font-size:14px'>Resource Templates</span>"]
        end
        
        subgraph ARGOCD["🚀 ARGOCD"]
            ARGOCD_SERVER["<b>🖥️ ArgoCD Server</b><br/><span style='color:#666;font-size:14px'>GitOps Controller</span>"]
            ARGOCD_APPLICATIONS["<b>📱 Applications</b><br/><span style='color:#666;font-size:14px'>App Definitions</span>"]
            ARGOCD_PROJECTS["<b>📁 Projects</b><br/><span style='color:#666;font-size:14px'>RBAC & Policies</span>"]
            ARGOCD_CLUSTERS["<b>🌐 Cluster Registry</b><br/><span style='color:#666;font-size:14px'>Multi-Cluster Mgmt</span>"]
        end
        
        subgraph MONITORING["📊 MONITORING"]
            PROMETHEUS_CP["<b>📈 Prometheus</b><br/><span style='color:#666;font-size:14px'>Control Plane</span>"]
            GRAFANA_CP["<b>📊 Grafana</b><br/><span style='color:#666;font-size:14px'>Dashboards</span>"]
            ALERTMANAGER_CP["<b>🚨 AlertManager</b><br/><span style='color:#666;font-size:14px'>Alerts</span>"]
        end
    end
    
    subgraph AWS_CLOUD["☁️ AWS CLOUD"]
        subgraph AWS_REGIONS["🌍 AWS REGIONS"]
            subgraph AWS_US_EAST["📍 US-East-1"]
                AWS_EKS_1["<b>☸️ EKS Cluster</b><br/><span style='color:#666;font-size:14px'>Production</span>"]
                AWS_RDS_1["<b>🐘 RDS PostgreSQL</b><br/><span style='color:#666;font-size:14px'>Crossplane Managed</span>"]
                AWS_REDIS_1["<b>🔴 ElastiCache</b><br/><span style='color:#666;font-size:14px'>Crossplane Managed</span>"]
                AWS_S3_1["<b>🪣 S3 Buckets</b><br/><span style='color:#666;font-size:14px'>Crossplane Managed</span>"]
            end
            
            subgraph AWS_US_WEST["📍 US-West-2"]
                AWS_EKS_2["<b>☸️ EKS Cluster</b><br/><span style='color:#666;font-size:14px'>DR/Backup</span>"]
                AWS_RDS_2["<b>🐘 RDS PostgreSQL</b><br/><span style='color:#666;font-size:14px'>Read Replica</span>"]
                AWS_REDIS_2["<b>🔴 ElastiCache</b><br/><span style='color:#666;font-size:14px'>Global Datastore</span>"]
                AWS_S3_2["<b>🪣 S3 Buckets</b><br/><span style='color:#666;font-size:14px'>Cross-Region</span>"]
            end
        end
    end
    
    subgraph GCP_CLOUD["☁️ GOOGLE CLOUD"]
        subgraph GCP_REGIONS["🌍 GCP REGIONS"]
            subgraph GCP_US_CENTRAL["📍 US-Central1"]
                GCP_GKE_1["<b>☸️ GKE Cluster</b><br/><span style='color:#666;font-size:14px'>Production</span>"]
                GCP_CLOUD_SQL_1["<b>🐘 Cloud SQL</b><br/><span style='color:#666;font-size:14px'>Crossplane Managed</span>"]
                GCP_REDIS_1["<b>🔴 Memorystore</b><br/><span style='color:#666;font-size:14px'>Crossplane Managed</span>"]
                GCP_STORAGE_1["<b>🪣 Cloud Storage</b><br/><span style='color:#666;font-size:14px'>Crossplane Managed</span>"]
            end
            
            subgraph GCP_ASIA["📍 Asia-Southeast1"]
                GCP_GKE_2["<b>☸️ GKE Cluster</b><br/><span style='color:#666;font-size:14px'>Asia Pacific</span>"]
                GCP_CLOUD_SQL_2["<b>🐘 Cloud SQL</b><br/><span style='color:#666;font-size:14px'>Regional</span>"]
                GCP_REDIS_2["<b>🔴 Memorystore</b><br/><span style='color:#666;font-size:14px'>Regional</span>"]
                GCP_STORAGE_2["<b>🪣 Cloud Storage</b><br/><span style='color:#666;font-size:14px'>Regional</span>"]
            end
        end
    end
    
    subgraph AZURE_CLOUD["☁️ MICROSOFT AZURE"]
        subgraph AZURE_REGIONS["🌍 AZURE REGIONS"]
            subgraph AZURE_US_EAST["📍 East US"]
                AZURE_AKS_1["<b>☸️ AKS Cluster</b><br/><span style='color:#666;font-size:14px'>Production</span>"]
                AZURE_POSTGRES_1["<b>🐘 Azure Database</b><br/><span style='color:#666;font-size:14px'>Crossplane Managed</span>"]
                AZURE_REDIS_1["<b>🔴 Azure Cache</b><br/><span style='color:#666;font-size:14px'>Crossplane Managed</span>"]
                AZURE_STORAGE_1["<b>🪣 Blob Storage</b><br/><span style='color:#666;font-size:14px'>Crossplane Managed</span>"]
            end
            
            subgraph AZURE_EUROPE["📍 West Europe"]
                AZURE_AKS_2["<b>☸️ AKS Cluster</b><br/><span style='color:#666;font-size:14px'>EU Region</span>"]
                AZURE_POSTGRES_2["<b>🐘 Azure Database</b><br/><span style='color:#666;font-size:14px'>EU Data</span>"]
                AZURE_REDIS_2["<b>🔴 Azure Cache</b><br/><span style='color:#666;font-size:14px'>EU Cache</span>"]
                AZURE_STORAGE_2["<b>🪣 Blob Storage</b><br/><span style='color:#666;font-size:14px'>EU Storage</span>"]
            end
        end
    end
    
    subgraph WORKLOAD_CLUSTERS["💼 WORKLOAD CLUSTERS"]
        subgraph APPS_AWS["📱 Applications on AWS"]
            API_GATEWAY_AWS["<b>🚪 API Gateway</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
            USER_SERVICE_AWS["<b>👤 User Service</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
            ORDER_SERVICE_AWS["<b>📦 Order Service</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
            PAYMENT_SERVICE_AWS["<b>💳 Payment Service</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
        end
        
        subgraph APPS_GCP["📱 Applications on GCP"]
            API_GATEWAY_GCP["<b>🚪 API Gateway</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
            USER_SERVICE_GCP["<b>👤 User Service</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
            ORDER_SERVICE_GCP["<b>📦 Order Service</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
            PAYMENT_SERVICE_GCP["<b>💳 Payment Service</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
        end
        
        subgraph APPS_AZURE["📱 Applications on Azure"]
            API_GATEWAY_AZURE["<b>🚪 API Gateway</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
            USER_SERVICE_AZURE["<b>👤 User Service</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
            ORDER_SERVICE_AZURE["<b>📦 Order Service</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
            PAYMENT_SERVICE_AZURE["<b>💳 Payment Service</b><br/><span style='color:#666;font-size:14px'>ArgoCD Managed</span>"]
        end
    end
    
    %% Git Repository Connections
    INFRA_REPO --> CROSSPLANE_CORE
    APP_REPO --> ARGOCD_SERVER
    CONFIG_REPO --> ARGOCD_SERVER
    
    %% Crossplane Provider Connections
    CROSSPLANE_CORE --> AWS_PROVIDER
    CROSSPLANE_CORE --> GCP_PROVIDER
    CROSSPLANE_CORE --> AZURE_PROVIDER
    
    %% Crossplane to Cloud Resources
    AWS_PROVIDER --> AWS_EKS_1
    AWS_PROVIDER --> AWS_RDS_1
    AWS_PROVIDER --> AWS_REDIS_1
    AWS_PROVIDER --> AWS_S3_1
    AWS_PROVIDER --> AWS_EKS_2
    AWS_PROVIDER --> AWS_RDS_2
    AWS_PROVIDER --> AWS_REDIS_2
    AWS_PROVIDER --> AWS_S3_2
    
    GCP_PROVIDER --> GCP_GKE_1
    GCP_PROVIDER --> GCP_CLOUD_SQL_1
    GCP_PROVIDER --> GCP_REDIS_1
    GCP_PROVIDER --> GCP_STORAGE_1
    GCP_PROVIDER --> GCP_GKE_2
    GCP_PROVIDER --> GCP_CLOUD_SQL_2
    GCP_PROVIDER --> GCP_REDIS_2
    GCP_PROVIDER --> GCP_STORAGE_2
    
    AZURE_PROVIDER --> AZURE_AKS_1
    AZURE_PROVIDER --> AZURE_POSTGRES_1
    AZURE_PROVIDER --> AZURE_REDIS_1
    AZURE_PROVIDER --> AZURE_STORAGE_1
    AZURE_PROVIDER --> AZURE_AKS_2
    AZURE_PROVIDER --> AZURE_POSTGRES_2
    AZURE_PROVIDER --> AZURE_REDIS_2
    AZURE_PROVIDER --> AZURE_STORAGE_2
    
    %% ArgoCD to Workload Clusters
    ARGOCD_SERVER --> AWS_EKS_1
    ARGOCD_SERVER --> AWS_EKS_2
    ARGOCD_SERVER --> GCP_GKE_1
    ARGOCD_SERVER --> GCP_GKE_2
    ARGOCD_SERVER --> AZURE_AKS_1
    ARGOCD_SERVER --> AZURE_AKS_2
    
    %% Applications on Clusters
    AWS_EKS_1 --> API_GATEWAY_AWS
    AWS_EKS_1 --> USER_SERVICE_AWS
    AWS_EKS_1 --> ORDER_SERVICE_AWS
    AWS_EKS_1 --> PAYMENT_SERVICE_AWS
    
    GCP_GKE_1 --> API_GATEWAY_GCP
    GCP_GKE_1 --> USER_SERVICE_GCP
    GCP_GKE_1 --> ORDER_SERVICE_GCP
    GCP_GKE_1 --> PAYMENT_SERVICE_GCP
    
    AZURE_AKS_1 --> API_GATEWAY_AZURE
    AZURE_AKS_1 --> USER_SERVICE_AZURE
    AZURE_AKS_1 --> ORDER_SERVICE_AZURE
    AZURE_AKS_1 --> PAYMENT_SERVICE_AZURE
    
    %% Monitoring Connections
    PROMETHEUS_CP --> CROSSPLANE_CORE
    PROMETHEUS_CP --> ARGOCD_SERVER
    GRAFANA_CP --> PROMETHEUS_CP
