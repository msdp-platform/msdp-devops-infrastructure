%%{init: {'theme':'base', 'themeVariables': { 'primaryColor': '#d32f2f', 'primaryTextColor': '#fff', 'primaryBorderColor': '#b71c1c', 'lineColor': '#ff9800', 'secondaryColor': '#1976d2', 'tertiaryColor': '#388e3c'}}}%%
graph TB
    subgraph CLIENT_LAYER["ğŸ–¥ï¸ CLIENT LAYER"]
        CLIENT["ğŸ“± Client Applications<br/>Mobile & Web"]
        API_GW["ğŸŒ API Gateway<br/>Rate Limiting & CORS"]
        AUTH_SVC["ğŸ” Authentication Service<br/>JWT & OAuth2"]
    end
    
    subgraph SECURITY_LAYER["ğŸ”’ SECURITY LAYER"]
        subgraph ACCESS_CONTROL["ğŸ›¡ï¸ ACCESS CONTROL"]
            RBAC["ğŸ‘¥ Role-Based Access Control<br/>RBAC Matrix"]
            RLS["ğŸ” Row Level Security<br/>Data Isolation"]
            PERMISSIONS["ğŸ“‹ Permission Matrix<br/>Granular Permissions"]
        end
        
        subgraph DATA_PROTECTION["ğŸ” DATA PROTECTION"]
            ENCRYPTION["ğŸ”’ Data Encryption<br/>AES-256 at Rest"]
            HASHING["ğŸ”‘ Password Hashing<br/>bcrypt + Salt"]
            AUDIT["ğŸ“ Audit Trail<br/>Complete Activity Log"]
        end
        
        subgraph NETWORK_SECURITY["ğŸŒ NETWORK SECURITY"]
            TLS["ğŸ” TLS 1.3<br/>End-to-End Encryption"]
            VPN["ğŸ”’ VPN Access<br/>Private Network"]
            FIREWALL["ğŸ”¥ Database Firewall<br/>IP Whitelisting"]
        end
    end
    
    subgraph DATABASE_LAYER["ğŸ—„ï¸ DATABASE LAYER"]
        POSTGRES[("ğŸ˜ PostgreSQL<br/>Encrypted Storage")]
        REDIS[("ğŸ”´ Redis<br/>Encrypted Cache")]
        ELASTIC[("ğŸ” Elasticsearch<br/>Encrypted Search")]
    end
    
    subgraph MONITORING_LAYER["ğŸ“Š MONITORING & COMPLIANCE"]
        LOGGING["ğŸ“ Security Logging<br/>SIEM Integration"]
        MONITORING["ğŸ“ˆ Real-time Monitoring<br/>Anomaly Detection"]
        COMPLIANCE["âœ… Compliance Checks<br/>GDPR, CCPA, SOX"]
    end
    
    %% Client to Security Flow
    CLIENT -->|"HTTPS"| API_GW
    API_GW -->|"JWT Validation"| AUTH_SVC
    AUTH_SVC -->|"Role Check"| RBAC
    RBAC -->|"Permission Check"| RLS
    RLS -->|"Data Access"| PERMISSIONS
    
    %% Network Security Flow
    API_GW -->|"TLS 1.3"| TLS
    TLS -->|"Encrypted Connection"| FIREWALL
    FIREWALL -->|"Filtered Access"| POSTGRES
    
    %% Data Protection Flow
    POSTGRES -->|"Encrypt Data"| ENCRYPTION
    POSTGRES -->|"Hash Passwords"| HASHING
    POSTGRES -->|"Log Activities"| AUDIT
    
    %% Monitoring Flow
    AUDIT -->|"Security Events"| LOGGING
    LOGGING -->|"Real-time Alerts"| MONITORING
    MONITORING -->|"Compliance Reports"| COMPLIANCE
