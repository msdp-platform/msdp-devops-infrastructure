%%{init: {'theme':'base', 'themeVariables': { 'primaryColor': '#1976d2', 'primaryTextColor': '#fff', 'primaryBorderColor': '#0d47a1', 'lineColor': '#ff9800', 'secondaryColor': '#388e3c', 'tertiaryColor': '#d32f2f'}}}%%
graph TB
    subgraph APP_LAYER["ğŸ–¥ï¸ APPLICATION LAYER"]
        APP1["ğŸŒ API Gateway<br/>Port: 3001"]
        APP2["ğŸ” Auth Service<br/>Port: 3002"]
        APP3["ğŸ“¦ Order Service<br/>Port: 3003"]
    end
    
    subgraph DB_LAYER["ğŸ—„ï¸ DATABASE LAYER"]
        POSTGRES[("ğŸ˜ PostgreSQL<br/>Port: 5432")]
        REDIS[("ğŸ”´ Redis<br/>Port: 6379")]
        ELASTIC[("ğŸ” Elasticsearch<br/>Port: 9200")]
    end
    
    subgraph MONITORING_STACK["ğŸ“Š MONITORING STACK"]
        PROMETHEUS["ğŸ“ˆ Prometheus<br/>Metrics Collection<br/>Port: 9090"]
        GRAFANA["ğŸ“Š Grafana<br/>Dashboards<br/>Port: 3000"]
        ALERTMANAGER["ğŸš¨ Alert Manager<br/>Alert Routing<br/>Port: 9093"]
        JAEGER["ğŸ” Jaeger Tracing<br/>Distributed Tracing<br/>Port: 16686"]
    end
    
    subgraph LOGGING_STACK["ğŸ“ LOGGING STACK"]
        FILEBEAT["ğŸ“„ Filebeat<br/>Log Shipper"]
        LOGSTASH["âš™ï¸ Logstash<br/>Log Processing<br/>Port: 5044"]
        ELASTICSEARCH_LOGS[("ğŸ” Elasticsearch Logs<br/>Log Storage<br/>Port: 9200")]
        KIBANA["ğŸ“Š Kibana<br/>Log Visualization<br/>Port: 5601"]
    end
    
    subgraph ALERTING["ğŸš¨ ALERTING CHANNELS"]
        SLACK["ğŸ’¬ Slack<br/>Team Notifications"]
        EMAIL["ğŸ“§ Email<br/>Critical Alerts"]
        PAGERDUTY["ğŸ“ PagerDuty<br/>On-call Alerts"]
        WEBHOOK["ğŸ”— Webhook<br/>Custom Integrations"]
    end
    
    %% Application to Database connections
    APP1 -->|"SQL Queries"| POSTGRES
    APP2 -->|"Cache Operations"| REDIS
    APP3 -->|"Search Queries"| ELASTIC
    
    %% Database to Monitoring
    POSTGRES -->|"Metrics Export"| PROMETHEUS
    REDIS -->|"Metrics Export"| PROMETHEUS
    ELASTIC -->|"Metrics Export"| PROMETHEUS
    
    %% Monitoring Stack connections
    PROMETHEUS -->|"Query Metrics"| GRAFANA
    PROMETHEUS -->|"Alert Rules"| ALERTMANAGER
    
    %% Application Tracing
    APP1 -->|"Trace Data"| JAEGER
    APP2 -->|"Trace Data"| JAEGER
    APP3 -->|"Trace Data"| JAEGER
    
    %% Logging Pipeline
    APP1 -->|"Application Logs"| FILEBEAT
    APP2 -->|"Application Logs"| FILEBEAT
    APP3 -->|"Application Logs"| FILEBEAT
    
    FILEBEAT -->|"Ship Logs"| LOGSTASH
    LOGSTASH -->|"Processed Logs"| ELASTICSEARCH_LOGS
    ELASTICSEARCH_LOGS -->|"Query Logs"| KIBANA
    
    %% Alerting connections
    ALERTMANAGER -->|"Team Alerts"| SLACK
    ALERTMANAGER -->|"Critical Alerts"| EMAIL
    ALERTMANAGER -->|"Emergency Alerts"| PAGERDUTY
    ALERTMANAGER -->|"Custom Alerts"| WEBHOOK
