%%{init: {'theme':'base', 'themeVariables': { 'primaryColor': '#1976d2', 'primaryTextColor': '#fff', 'primaryBorderColor': '#0d47a1', 'lineColor': '#ff9800', 'secondaryColor': '#388e3c', 'tertiaryColor': '#d32f2f'}}}%%
graph TB
    subgraph APP_LAYER["🖥️ APPLICATION LAYER"]
        APP1["🌐 API Gateway<br/>Port: 3001"]
        APP2["🔐 Auth Service<br/>Port: 3002"]
        APP3["📦 Order Service<br/>Port: 3003"]
    end
    
    subgraph DB_LAYER["🗄️ DATABASE LAYER"]
        POSTGRES[("🐘 PostgreSQL<br/>Port: 5432")]
        REDIS[("🔴 Redis<br/>Port: 6379")]
        ELASTIC[("🔎 Elasticsearch<br/>Port: 9200")]
    end
    
    subgraph MONITORING_STACK["📊 MONITORING STACK"]
        PROMETHEUS["📈 Prometheus<br/>Metrics Collection<br/>Port: 9090"]
        GRAFANA["📊 Grafana<br/>Dashboards<br/>Port: 3000"]
        ALERTMANAGER["🚨 Alert Manager<br/>Alert Routing<br/>Port: 9093"]
        JAEGER["🔍 Jaeger Tracing<br/>Distributed Tracing<br/>Port: 16686"]
    end
    
    subgraph LOGGING_STACK["📝 LOGGING STACK"]
        FILEBEAT["📄 Filebeat<br/>Log Shipper"]
        LOGSTASH["⚙️ Logstash<br/>Log Processing<br/>Port: 5044"]
        ELASTICSEARCH_LOGS[("🔎 Elasticsearch Logs<br/>Log Storage<br/>Port: 9200")]
        KIBANA["📊 Kibana<br/>Log Visualization<br/>Port: 5601"]
    end
    
    subgraph ALERTING["🚨 ALERTING CHANNELS"]
        SLACK["💬 Slack<br/>Team Notifications"]
        EMAIL["📧 Email<br/>Critical Alerts"]
        PAGERDUTY["📞 PagerDuty<br/>On-call Alerts"]
        WEBHOOK["🔗 Webhook<br/>Custom Integrations"]
    end
    
    %% Application to Database connections
    APP1 -->|"SQL Queries"| POSTGRES
    APP2 -->|"Cache Operations"| REDIS
    APP3 -->|"Search Queries"| ELASTIC
    
    %% Database to Monitoring
    POSTGRES -->|"Metrics Export"| PROMETHEUS
    REDIS -->|"Metrics Export"| PROMETHEUS
    ELASTIC -->|"Metrics Export"| PROMETHEUS
    
    %% Monitoring Stack connections
    PROMETHEUS -->|"Query Metrics"| GRAFANA
    PROMETHEUS -->|"Alert Rules"| ALERTMANAGER
    
    %% Application Tracing
    APP1 -->|"Trace Data"| JAEGER
    APP2 -->|"Trace Data"| JAEGER
    APP3 -->|"Trace Data"| JAEGER
    
    %% Logging Pipeline
    APP1 -->|"Application Logs"| FILEBEAT
    APP2 -->|"Application Logs"| FILEBEAT
    APP3 -->|"Application Logs"| FILEBEAT
    
    FILEBEAT -->|"Ship Logs"| LOGSTASH
    LOGSTASH -->|"Processed Logs"| ELASTICSEARCH_LOGS
    ELASTICSEARCH_LOGS -->|"Query Logs"| KIBANA
    
    %% Alerting connections
    ALERTMANAGER -->|"Team Alerts"| SLACK
    ALERTMANAGER -->|"Critical Alerts"| EMAIL
    ALERTMANAGER -->|"Emergency Alerts"| PAGERDUTY
    ALERTMANAGER -->|"Custom Alerts"| WEBHOOK
